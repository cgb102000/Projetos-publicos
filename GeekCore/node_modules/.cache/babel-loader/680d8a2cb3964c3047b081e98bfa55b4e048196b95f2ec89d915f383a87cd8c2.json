{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Caio\\\\Documents\\\\GitHub\\\\Projetos-publicos\\\\GeekCore\\\\src\\\\pages\\\\Callback.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useContext } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { AuthContext } from '../contexts/AuthContext';\nimport { adjustBrightness } from '../utils/themeUtils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function Callback() {\n  _s();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const {\n    dispatch\n  } = useContext(AuthContext);\n  useEffect(() => {\n    const processAuth = async () => {\n      try {\n        const params = new URLSearchParams(location.search);\n        const token = params.get('token');\n        const userStr = params.get('user');\n        if (!token || !userStr) {\n          throw new Error('Dados de autenticação inválidos');\n        }\n        const user = JSON.parse(decodeURIComponent(userStr));\n\n        // Salvar no localStorage\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(user));\n\n        // Aplicar tema do usuário\n        if (user.tema_cor) {\n          document.documentElement.style.setProperty('--color-primary', user.tema_cor);\n          document.documentElement.style.setProperty('--color-hover', adjustBrightness(user.tema_cor, -15));\n        }\n\n        // Atualizar contexto\n        dispatch({\n          type: 'LOGIN',\n          payload: {\n            user,\n            token\n          }\n        });\n        navigate('/', {\n          replace: true\n        });\n      } catch (error) {\n        console.error('Erro no callback:', error);\n        navigate('/login?error=auth_failed');\n      }\n    };\n    processAuth();\n  }, [location, navigate, dispatch]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen flex items-center justify-center bg-darker\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-white text-xl\",\n      children: \"Processando autentica\\xE7\\xE3o...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 5\n  }, this);\n}\n_s(Callback, \"nJ4WwW2CwuU9irK1WBQZkkRnngA=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = Callback;\nvar _c;\n$RefreshReg$(_c, \"Callback\");","map":{"version":3,"names":["useEffect","useContext","useNavigate","useLocation","AuthContext","adjustBrightness","jsxDEV","_jsxDEV","Callback","_s","navigate","location","dispatch","processAuth","params","URLSearchParams","search","token","get","userStr","Error","user","JSON","parse","decodeURIComponent","localStorage","setItem","stringify","tema_cor","document","documentElement","style","setProperty","type","payload","replace","error","console","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Caio/Documents/GitHub/Projetos-publicos/GeekCore/src/pages/Callback.js"],"sourcesContent":["import { useEffect, useContext } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { AuthContext } from '../contexts/AuthContext';\r\nimport { adjustBrightness } from '../utils/themeUtils';\r\n\r\nexport function Callback() {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { dispatch } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    const processAuth = async () => {\r\n      try {\r\n        const params = new URLSearchParams(location.search);\r\n        const token = params.get('token');\r\n        const userStr = params.get('user');\r\n        \r\n        if (!token || !userStr) {\r\n          throw new Error('Dados de autenticação inválidos');\r\n        }\r\n\r\n        const user = JSON.parse(decodeURIComponent(userStr));\r\n        \r\n        // Salvar no localStorage\r\n        localStorage.setItem('token', token);\r\n        localStorage.setItem('user', JSON.stringify(user));\r\n\r\n        // Aplicar tema do usuário\r\n        if (user.tema_cor) {\r\n          document.documentElement.style.setProperty('--color-primary', user.tema_cor);\r\n          document.documentElement.style.setProperty('--color-hover', adjustBrightness(user.tema_cor, -15));\r\n        }\r\n\r\n        // Atualizar contexto\r\n        dispatch({ type: 'LOGIN', payload: { user, token } });\r\n        \r\n        navigate('/', { replace: true });\r\n      } catch (error) {\r\n        console.error('Erro no callback:', error);\r\n        navigate('/login?error=auth_failed');\r\n      }\r\n    };\r\n\r\n    processAuth();\r\n  }, [location, navigate, dispatch]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-darker\">\r\n      <div className=\"text-white text-xl\">Processando autenticação...</div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AAAA,SAASA,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAC7C,SAASC,WAAW,EAAEC,WAAW,QAAQ,kBAAkB;AAC3D,SAASC,WAAW,QAAQ,yBAAyB;AACrD,SAASC,gBAAgB,QAAQ,qBAAqB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEvD,OAAO,SAASC,QAAQA,CAAA,EAAG;EAAAC,EAAA;EACzB,MAAMC,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAC9B,MAAMS,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAES;EAAS,CAAC,GAAGX,UAAU,CAACG,WAAW,CAAC;EAE5CJ,SAAS,CAAC,MAAM;IACd,MAAMa,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,IAAI;QACF,MAAMC,MAAM,GAAG,IAAIC,eAAe,CAACJ,QAAQ,CAACK,MAAM,CAAC;QACnD,MAAMC,KAAK,GAAGH,MAAM,CAACI,GAAG,CAAC,OAAO,CAAC;QACjC,MAAMC,OAAO,GAAGL,MAAM,CAACI,GAAG,CAAC,MAAM,CAAC;QAElC,IAAI,CAACD,KAAK,IAAI,CAACE,OAAO,EAAE;UACtB,MAAM,IAAIC,KAAK,CAAC,iCAAiC,CAAC;QACpD;QAEA,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACC,kBAAkB,CAACL,OAAO,CAAC,CAAC;;QAEpD;QACAM,YAAY,CAACC,OAAO,CAAC,OAAO,EAAET,KAAK,CAAC;QACpCQ,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEJ,IAAI,CAACK,SAAS,CAACN,IAAI,CAAC,CAAC;;QAElD;QACA,IAAIA,IAAI,CAACO,QAAQ,EAAE;UACjBC,QAAQ,CAACC,eAAe,CAACC,KAAK,CAACC,WAAW,CAAC,iBAAiB,EAAEX,IAAI,CAACO,QAAQ,CAAC;UAC5EC,QAAQ,CAACC,eAAe,CAACC,KAAK,CAACC,WAAW,CAAC,eAAe,EAAE3B,gBAAgB,CAACgB,IAAI,CAACO,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC;QACnG;;QAEA;QACAhB,QAAQ,CAAC;UAAEqB,IAAI,EAAE,OAAO;UAAEC,OAAO,EAAE;YAAEb,IAAI;YAAEJ;UAAM;QAAE,CAAC,CAAC;QAErDP,QAAQ,CAAC,GAAG,EAAE;UAAEyB,OAAO,EAAE;QAAK,CAAC,CAAC;MAClC,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,mBAAmB,EAAEA,KAAK,CAAC;QACzC1B,QAAQ,CAAC,0BAA0B,CAAC;MACtC;IACF,CAAC;IAEDG,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,CAACF,QAAQ,EAAED,QAAQ,EAAEE,QAAQ,CAAC,CAAC;EAElC,oBACEL,OAAA;IAAK+B,SAAS,EAAC,yDAAyD;IAAAC,QAAA,eACtEhC,OAAA;MAAK+B,SAAS,EAAC,oBAAoB;MAAAC,QAAA,EAAC;IAA2B;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAClE,CAAC;AAEV;AAAClC,EAAA,CA9CeD,QAAQ;EAAA,QACLN,WAAW,EACXC,WAAW;AAAA;AAAAyC,EAAA,GAFdpC,QAAQ;AAAA,IAAAoC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}