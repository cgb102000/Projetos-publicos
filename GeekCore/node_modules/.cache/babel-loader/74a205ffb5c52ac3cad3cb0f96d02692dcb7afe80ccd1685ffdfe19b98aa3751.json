{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Caio\\\\Documents\\\\GitHub\\\\Projetos-publicos\\\\GeekCore\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useReducer, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  isAuthenticated: false,\n  user: null,\n  token: null,\n  loading: true\n};\nfunction authReducer(state, action) {\n  switch (action.type) {\n    case 'LOGIN':\n      return {\n        ...state,\n        isAuthenticated: true,\n        user: action.payload.user,\n        token: action.payload.token,\n        loading: false\n      };\n    case 'LOGOUT':\n      return {\n        ...state,\n        isAuthenticated: false,\n        user: null,\n        token: null,\n        loading: false\n      };\n    case 'SET_LOADING':\n      return {\n        ...state,\n        loading: action.payload\n      };\n    case 'UPDATE_USER':\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          ...action.payload.user\n        }\n      };\n    default:\n      return state;\n  }\n}\nexport const AuthContext = /*#__PURE__*/createContext();\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [state, dispatch] = useReducer(authReducer, {\n    isAuthenticated: false,\n    user: null,\n    token: null,\n    loading: true\n  });\n  useEffect(() => {\n    const initAuth = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        const savedUser = localStorage.getItem('user');\n        if (token && savedUser) {\n          const user = JSON.parse(savedUser);\n          dispatch({\n            type: 'LOGIN',\n            payload: {\n              user,\n              token\n            }\n          });\n\n          // Aplicar tema salvo\n          if (user.tema_cor) {\n            document.documentElement.style.setProperty('--color-primary', user.tema_cor);\n            document.documentElement.style.setProperty('--color-hover', adjustBrightness(user.tema_cor, -15));\n          }\n        }\n      } catch (error) {\n        console.error('Erro ao restaurar sessão:', error);\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n      } finally {\n        dispatch({\n          type: 'SET_LOADING',\n          payload: false\n        });\n      }\n    };\n    initAuth();\n  }, []);\n\n  // Adicionar manipulador de eventos para storage\n  useEffect(() => {\n    const handleStorageChange = e => {\n      if (e.key === 'token' || e.key === 'user') {\n        const token = localStorage.getItem('token');\n        const user = JSON.parse(localStorage.getItem('user') || 'null');\n        if (token && user) {\n          dispatch({\n            type: 'LOGIN',\n            payload: {\n              user,\n              token\n            }\n          });\n        } else {\n          dispatch({\n            type: 'LOGOUT'\n          });\n        }\n      }\n    };\n    window.addEventListener('storage', handleStorageChange);\n    return () => window.removeEventListener('storage', handleStorageChange);\n  }, []);\n  const updateUserData = userData => {\n    dispatch({\n      type: 'UPDATE_USER',\n      payload: {\n        user: {\n          ...state.user,\n          ...userData\n        },\n        token: state.token\n      }\n    });\n    // Atualizar também no localStorage\n    const currentUser = JSON.parse(localStorage.getItem('user') || '{}');\n    localStorage.setItem('user', JSON.stringify({\n      ...currentUser,\n      ...userData\n    }));\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      ...state,\n      dispatch,\n      updateUserData,\n      isAuthenticated: !!state.token\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"nTzL+nWvOAdW79aaZUazPdP30R0=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useReducer","useEffect","jsxDEV","_jsxDEV","initialState","isAuthenticated","user","token","loading","authReducer","state","action","type","payload","AuthContext","AuthProvider","children","_s","dispatch","initAuth","localStorage","getItem","savedUser","JSON","parse","tema_cor","document","documentElement","style","setProperty","adjustBrightness","error","console","removeItem","handleStorageChange","e","key","window","addEventListener","removeEventListener","updateUserData","userData","currentUser","setItem","stringify","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Caio/Documents/GitHub/Projetos-publicos/GeekCore/src/contexts/AuthContext.js"],"sourcesContent":["import { createContext, useReducer, useEffect } from 'react';\r\n\r\nconst initialState = {\r\n  isAuthenticated: false,\r\n  user: null,\r\n  token: null,\r\n  loading: true\r\n};\r\n\r\nfunction authReducer(state, action) {\r\n  switch (action.type) {\r\n    case 'LOGIN':\r\n      return {\r\n        ...state,\r\n        isAuthenticated: true,\r\n        user: action.payload.user,\r\n        token: action.payload.token,\r\n        loading: false\r\n      };\r\n    case 'LOGOUT':\r\n      return {\r\n        ...state,\r\n        isAuthenticated: false,\r\n        user: null,\r\n        token: null,\r\n        loading: false\r\n      };\r\n    case 'SET_LOADING':\r\n      return {\r\n        ...state,\r\n        loading: action.payload\r\n      };\r\n    case 'UPDATE_USER':\r\n      return {\r\n        ...state,\r\n        user: { ...state.user, ...action.payload.user }\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [state, dispatch] = useReducer(authReducer, {\r\n    isAuthenticated: false,\r\n    user: null,\r\n    token: null,\r\n    loading: true\r\n  });\r\n\r\n  useEffect(() => {\r\n    const initAuth = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const savedUser = localStorage.getItem('user');\r\n\r\n        if (token && savedUser) {\r\n          const user = JSON.parse(savedUser);\r\n          dispatch({ type: 'LOGIN', payload: { user, token } });\r\n\r\n          // Aplicar tema salvo\r\n          if (user.tema_cor) {\r\n            document.documentElement.style.setProperty('--color-primary', user.tema_cor);\r\n            document.documentElement.style.setProperty('--color-hover', adjustBrightness(user.tema_cor, -15));\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Erro ao restaurar sessão:', error);\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('user');\r\n      } finally {\r\n        dispatch({ type: 'SET_LOADING', payload: false });\r\n      }\r\n    };\r\n\r\n    initAuth();\r\n  }, []);\r\n\r\n  // Adicionar manipulador de eventos para storage\r\n  useEffect(() => {\r\n    const handleStorageChange = (e) => {\r\n      if (e.key === 'token' || e.key === 'user') {\r\n        const token = localStorage.getItem('token');\r\n        const user = JSON.parse(localStorage.getItem('user') || 'null');\r\n        \r\n        if (token && user) {\r\n          dispatch({ type: 'LOGIN', payload: { user, token } });\r\n        } else {\r\n          dispatch({ type: 'LOGOUT' });\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('storage', handleStorageChange);\r\n    return () => window.removeEventListener('storage', handleStorageChange);\r\n  }, []);\r\n\r\n  const updateUserData = (userData) => {\r\n    dispatch({ \r\n      type: 'UPDATE_USER', \r\n      payload: { \r\n        user: { ...state.user, ...userData },\r\n        token: state.token \r\n      } \r\n    });\r\n    // Atualizar também no localStorage\r\n    const currentUser = JSON.parse(localStorage.getItem('user') || '{}');\r\n    localStorage.setItem('user', JSON.stringify({ ...currentUser, ...userData }));\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ \r\n      ...state, \r\n      dispatch,\r\n      updateUserData,\r\n      isAuthenticated: !!state.token \r\n    }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}